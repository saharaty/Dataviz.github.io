<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Heatmap using D3.js</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        rect {
            stroke: #fff;
        }
    </style>
</head>
<body>
    <div id="heatmap"></div>

    <script>
        // Fetch the JSON data
        fetch('/heatmap.json')
      
            .then(response => response.json())
            .then(data => {
                // Find unique cities and tree types
                const cities = Array.from(new Set(data.map(d => d.city)));
                const treeTypes = Array.from(new Set(data.map(d => d.tree_type)));
                
                // Define the size of the heatmap
                const width = 600;
                const height = 400;
                
                // Create the SVG container
                const svg = d3.select("#heatmap")
                    .append("svg")
                    .attr("width", width)
                    .attr("height", height);

                // Define the scales
                const xScale = d3.scaleBand()
                    .domain(cities)
                    .range([0, width])
                    .padding(0.1);
                
                const yScale = d3.scaleBand()
                    .domain(treeTypes)
                    .range([0, height])
                    .padding(0.1);

                const colorScale = d3.scaleLinear()
                    .domain([0, d3.max(data, d => d.count)])
                    .range(["white", "steelblue"]);

                // Draw the heatmap
                svg.selectAll()
                    .data(data)
                    .enter()
                    .append("rect")
                    .attr("x", d => xScale(d.city))
                    .attr("y", d => yScale(d.tree_type))
                    .attr("width", xScale.bandwidth())
                    .attr("height", yScale.bandwidth())
                    .attr("fill", d => colorScale(d.count));
            });
    </script>
</body>
</html>
